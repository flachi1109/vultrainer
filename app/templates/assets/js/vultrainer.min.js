/*! vultrainer 07-06-2017 */

angular.module("dashboard",["platformNode"]).controller("nodeInfoController",["$rootScope","$scope","nodeService",function(e,n,r){function t(e){n.nodeInfo=e}function o(e){n.errorType="Retrieve Data Error : ",n.errorDetail=e,n.alertShown=!0}r.getNodeInfo(e.nodeId).then(t,o)}]),angular.module("platformNode",[]).service("nodeService",["$http","$q",function(e,n){this.nodeId="",this.setNodeId=function(e){this.nodeId=e},this.getNodeId=function(){return this.nodeId},this.getNodeInfo=function(r){var t=n.defer();return e.get("/"+r+"/dashboard/nodeinfo").then(function(e){t.resolve(e.data)},function(e){t.reject(e.data)}),t.promise}}]),angular.module("vulnContainer",["ngTable"]).factory("vulnContainerService",["$http","$q",function(e,n){var r={};return r.getVulnContainerList=function(r){var t=n.defer();return e.get("/"+r+"/vulnContainer/all").then(function(e){t.resolve(e.data)},function(e){t.reject(e.data)}),t.promise},r.operateContainer=function(r,t,o){var a=n.defer();return e.get("/"+r+"/vulnContainer/"+t+"/"+o).then(function(e){a.resolve(e.data)},function(e){a.reject(e.data)}),a.promise},r}]).filter("retInnerPort",function(){return function(e){return e.split("/")[0]}}).filter("retProto",function(){return function(e){return e.split("/")[1]}}).controller("vulnContainerController",["$rootScope","$scope","$timeout","vulnContainerService","NgTableParams",function(e,n,r,t,o){function a(e){l.containerTableParams=new o({},{dataset:e})}function i(e){n.errorType="Retrieve Data Error : ",n.errorDetail=e,n.alertShown=!0}var l=this;t.getVulnContainerList(e.nodeId).then(a,i),n.containerCheckeds=[],n.selectContainer=function(e){if(1==e.checked)n.containerCheckeds.push(e.id);else for(var r=0;r<n.containerCheckeds.length;r++)n.containerCheckeds[r]==e.id&&n.containerCheckeds.splice(r,1);console.log(n.containerCheckeds)},n.containerAction=function(r){function o(n){t.getVulnContainerList(e.nodeId).then(a,i)}function l(e){n.errorType="Operated Failed : ",n.errorDetail=e,n.alertShown=!0}console.log(r);for(var d=0;d<n.containerCheckeds.length;d++)t.operateContainer(e.nodeId,n.containerCheckeds[d],r).then(o,l);n.containerCheckeds=[]}}]),angular.module("vultrainer",["ui.router","platformNode","dashboard","vulnContainer"]).config(["$stateProvider","$urlRouterProvider",function(e,n){n.otherwise("/dashboard/"),e.state("dashboard",{url:"/dashboard/",templateUrl:"/dashboard/",controller:"vultrainerController"}),e.state("vulnContainer",{url:"/vulnContainer/",templateUrl:"/vulnContainer/",controller:"vultrainerController"})}]).controller("vultrainerController",["$rootScope","$scope","nodeService",function(e,n,r){r.setNodeId(1),e.nodeId=r.getNodeId()}]);