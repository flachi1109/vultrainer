{% load staticfiles %}

<div class="breadcrumbs" id="breadcrumbs">
	<script type="text/javascript">
		try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
	</script>

	<ul class="breadcrumb">
		<li>
			<i class="icon-home home-icon"></i>
			<a href="#">首页</a>
		</li>
		<li class="active">控制台</li>
	</ul><!-- .breadcrumb -->

	<div class="nav-search" id="nav-search">
		<form class="form-search">
			<span class="input-icon">
				<input type="text" placeholder="Search ..." class="nav-search-input" id="nav-search-input" autocomplete="off" />
				<i class="icon-search nav-search-icon"></i>
			</span>
		</form>
	</div><!-- #nav-search -->
</div>

<div class="page-content">
	<div class="page-header">
		<h1>
			控制台
			<small>
				<i class="icon-double-angle-right"></i>
				 查看
			</small>
		</h1>
	</div><!-- /.page-header -->

	<div class="row">
		<div class="col-xs-12 col-md-12">
			<!-- PAGE CONTENT BEGINS -->

			{% include 'alert_block.html' %}

			<div class="row">
				<div class="space-6"></div>

				<div class="col-xs-6 col-md-6">
					<div class="widget-header widget-header-flat widget-header-small">
							<h5>
								<i class="icon-signal"></i>
								当前节点信息
							</h5>

						</div>
					{% verbatim %}
					<div class="table-responsive" ng-controller='nodeInfoController'>
						<table id="endpoint_info_table" class="table table-striped table-bordered table-hover">


							<tbody>
								<tr>
									<td>
										<a href="#">节点系统</a>
									</td>
									<td class="hidden-480">
										<span class="label label-sm label-primary arrowed arrowed-right">{{ nodeInfo.os_type }}</span>
									</td>

								</tr>

								<tr>
									<td>
										<a href="#">节点名称</a>
									</td>

									<td class="hidden-480">
										<span class="label label-sm label-primary arrowed arrowed-right">{{ nodeInfo.sys_name }}</span>
									</td>
								</tr>

								<tr>
									<td>
										<a href="#">系统架构</a>
									</td>

									<td class="hidden-480">
										<span class="label label-sm label-primary arrowed arrowed-right">{{ nodeInfo.arch }}</span>
									</td>
								</tr>

								<tr>
									<td>
										<a href="#">CPU数量</a>
									</td>

									<td class="hidden-480">
										<span class="label label-sm label-primary arrowed arrowed-right">{{ nodeInfo.cpu_count }}</span>
									</td>
								</tr>
                                
                                <tr>
									<td>
										<a href="#">系统内存</a>
									</td>

									<td class="hidden-480">
										<span class="label label-sm label-primary arrowed arrowed-right">{{ nodeInfo.total_mem/1024/1024 | number:0 }} MB</span>
									</td>
								</tr>
                                
                                <tr>
									<td>
										<a href="#">Docker版本</a>
									</td>

									<td class="hidden-480">
										<span class="label label-sm label-primary arrowed arrowed-right">{{ nodeInfo.docker_version }}</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div><!-- /.table-responsive -->
					{% endverbatim %}
				</div>

				<div class="vspace-sm"></div>

				<div class="col-sm-6">
					<div class="widget-box">
						<div class="widget-header widget-header-flat widget-header-small">
							<h5>
								<i class="icon-signal"></i>
								访问来源
							</h5>

							<div class="widget-toolbar no-border">
								<button class="btn btn-minier btn-primary dropdown-toggle" data-toggle="dropdown">
									本周
									<i class="icon-angle-down icon-on-right bigger-110"></i>
								</button>

								<ul class="dropdown-menu pull-right dropdown-125 dropdown-lighter dropdown-caret">
									<li class="active">
										<a href="#" class="blue">
											<i class="icon-caret-right bigger-110">&nbsp;</i>
											本周
										</a>
									</li>

									<li>
										<a href="#">
											<i class="icon-caret-right bigger-110 invisible">&nbsp;</i>
											上周
										</a>
									</li>

									<li>
										<a href="#">
											<i class="icon-caret-right bigger-110 invisible">&nbsp;</i>
											本月
										</a>
									</li>

									<li>
										<a href="#">
											<i class="icon-caret-right bigger-110 invisible">&nbsp;</i>
											上月
										</a>
									</li>
								</ul>
							</div>
						</div>

						<div class="widget-body">
							<div class="widget-main">
								<div id="piechart-placeholder"></div>

								<div class="hr hr8 hr-double"></div>

								<div class="clearfix">
									<div class="grid3">
										<span class="grey">
											<i class="icon-facebook-sign icon-2x blue"></i>
											&nbsp; likes
										</span>
										<h4 class="bigger pull-right">1,255</h4>
									</div>

									<div class="grid3">
										<span class="grey">
											<i class="icon-twitter-sign icon-2x purple"></i>
											&nbsp; tweets
										</span>
										<h4 class="bigger pull-right">941</h4>
									</div>

									<div class="grid3">
										<span class="grey">
											<i class="icon-pinterest-sign icon-2x red"></i>
											&nbsp; pins
										</span>
										<h4 class="bigger pull-right">1,050</h4>
									</div>
								</div>
							</div><!-- /widget-main -->
						</div><!-- /widget-body -->
					</div><!-- /widget-box -->
				</div><!-- /span -->
			</div><!-- /row -->

			<!-- Node key resource amount -->
			<div class="hr hr32 hr-dotted"></div>
			<div class="row">
				<div class="col-xs-12 col-md-12">
					<div class="row">
						<div class="col-xs-6 col-md-6">
							<button class="btn btn-light btn-block btn-elg">
								<div class="summary-ico">
									<i class="fa fa-bug fa-4x icon-only"></i>
									
								</div>
								<div class="summary-info">
									<div class="summary-amount">
										<div>2</div>
										<div>Target Machines</div>
									</div>
									<div class="summary-status">
										
									</div>
								</div>
							</button>
						</div>
						<div class="col-xs-6 col-md-6">
							<button class="btn btn-light btn-block btn-elg">
								<div class="summary-ico">
									<i class="fa fa-tasks fa-4x icon-only"></i>
									
								</div>
								<div class="summary-info">
									<div class="summary-amount">
										<div>3</div>
										<div>Target Images</div>
									</div>
									<div class="summary-status">
										
									</div>
								</div>
							</button>
						</div>
					</div>
				</div>
			</div>
			<div class="space-6"></div>
			<div class="row">
				<div class="col-xs-12 col-md-12">
					<div class="row">
						<div class="col-xs-6 col-md-6">
							<button class="btn btn-light btn-block btn-elg">
								<div class="summary-ico">
									<i class="fa fa-hdd-o fa-4x icon-only"></i>
									
								</div>
								<div class="summary-info">
									<div class="summary-amount">
										<div>2</div>
										<div>Volumes</div>
									</div>
									<div class="summary-status">
										
									</div>
								</div>
							</button>
						</div>
						<div class="col-xs-6 col-md-6">
							<button class="btn btn-light btn-block btn-elg">
								<div class="summary-ico">
									<i class="fa fa-sitemap fa-4x icon-only"></i>
									
								</div>
								<div class="summary-info">
									<div class="summary-amount">
										<div>2</div>
										<div>Networks</div>
									</div>
									<div class="summary-status">
										
									</div>
								</div>
							</button>
						</div>
					</div>
				</div>
			</div>


			<!-- Node key resource amount ENDS -->
		</div><!-- /.col -->
	</div><!-- /.row -->
</div><!-- /.page-content -->

<!-- page specific plugin scripts -->
<script src="{% static 'js/jquery-ui-1.10.3.custom.min.js' %}"></script>
<script src="{% static 'js/jquery.ui.touch-punch.min.js' %}"></script>
<script src="{% static 'js/jquery.slimscroll.min.js' %}"></script>
<script src="{% static 'js/jquery.easy-pie-chart.min.js' %}"></script>
<script src="{% static 'js/jquery.sparkline.min.js' %}"></script>
<script src="{% static 'js/flot/jquery.flot.min.js' %}"></script>
<script src="{% static 'js/flot/jquery.flot.pie.min.js' %}"></script>
<script src="{% static 'js/flot/jquery.flot.resize.min.js' %}"></script>
<script type="text/javascript">
            jQuery(function($) {
                $('.easy-pie-chart.percentage').each(function(){
                    var $box = $(this).closest('.infobox');
                    var barColor = $(this).data('color') || (!$box.hasClass('infobox-dark') ? $box.css('color') : 'rgba(255,255,255,0.95)');
                    var trackColor = barColor == 'rgba(255,255,255,0.95)' ? 'rgba(255,255,255,0.25)' : '#E2E2E2';
                    var size = parseInt($(this).data('size')) || 50;
                    $(this).easyPieChart({
                        barColor: barColor,
                        trackColor: trackColor,
                        scaleColor: false,
                        lineCap: 'butt',
                        lineWidth: parseInt(size/10),
                        animate: /msie\s*(8|7|6)/.test(navigator.userAgent.toLowerCase()) ? false : 1000,
                        size: size
                    });
                })
            
                $('.sparkline').each(function(){
                    var $box = $(this).closest('.infobox');
                    var barColor = !$box.hasClass('infobox-dark') ? $box.css('color') : '#FFF';
                    $(this).sparkline('html', {tagValuesAttribute:'data-values', type: 'bar', barColor: barColor , chartRangeMin:$(this).data('min') || 0} );
                });
            
            
            
            
              var placeholder = $('#piechart-placeholder').css({'width':'90%' , 'min-height':'150px'});
              var data = [
                { label: "social networks",  data: 38.7, color: "#68BC31"},
                { label: "search engines",  data: 24.5, color: "#2091CF"},
                { label: "ad campaigns",  data: 8.2, color: "#AF4E96"},
                { label: "direct traffic",  data: 18.6, color: "#DA5430"},
                { label: "other",  data: 10, color: "#FEE074"}
              ]
              function drawPieChart(placeholder, data, position) {
                  $.plot(placeholder, data, {
                    series: {
                        pie: {
                            show: true,
                            tilt:0.8,
                            highlight: {
                                opacity: 0.25
                            },
                            stroke: {
                                color: '#fff',
                                width: 2
                            },
                            startAngle: 2
                        }
                    },
                    legend: {
                        show: true,
                        position: position || "ne", 
                        labelBoxBorderColor: null,
                        margin:[-30,15]
                    }
                    ,
                    grid: {
                        hoverable: true,
                        clickable: true
                    }
                 })
             }
             drawPieChart(placeholder, data);
            
             /**
             we saved the drawing function and the data to redraw with different position later when switching to RTL mode dynamically
             so that's not needed actually.
             */
             placeholder.data('chart', data);
             placeholder.data('draw', drawPieChart);
            
            
            
              var $tooltip = $("<div class='tooltip top in'><div class='tooltip-inner'></div></div>").hide().appendTo('body');
              var previousPoint = null;
            
              placeholder.on('plothover', function (event, pos, item) {
                if(item) {
                    if (previousPoint != item.seriesIndex) {
                        previousPoint = item.seriesIndex;
                        var tip = item.series['label'] + " : " + item.series['percent']+'%';
                        $tooltip.show().children(0).text(tip);
                    }
                    $tooltip.css({top:pos.pageY + 10, left:pos.pageX + 10});
                } else {
                    $tooltip.hide();
                    previousPoint = null;
                }
                
             });

                var d1 = [];
                for (var i = 0; i < Math.PI * 2; i += 0.5) {
                    d1.push([i, Math.sin(i)]);
                }
            
                var d2 = [];
                for (var i = 0; i < Math.PI * 2; i += 0.5) {
                    d2.push([i, Math.cos(i)]);
                }
            
                var d3 = [];
                for (var i = 0; i < Math.PI * 2; i += 0.2) {
                    d3.push([i, Math.tan(i)]);
                }
    
            });
            
            // make the endpoint info table have the same height as widget
            $(".widget-body").bind('resize', function(){
                $('#endpoint_info_table').css('height', $(".widget-body").outerHeight())
            });
</script>